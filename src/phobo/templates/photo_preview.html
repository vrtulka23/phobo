<div id="app">
  <div class="container">
    <div class="row">
      <div class="col-6">
        <h2>Photo #{{ doc_id }}</h2>
      </div>
      <div class="col-6">
        <a href="{{ url_overview }}" class="btn btn-secondary float-end">Back to overview</a>
      </div>
    </div>
    <div class="row">
      <div class="col-md-3">
        <div class="row">
          <div class="col-12">
              <img :src="url_image" alt="thumbnail" class="img-thumbnail">
          </div>
          <div class="col-12 pt-2">
            <h4>Available variants</h4>
          </div>
          <div class="col-4" v-for="item in variant_list" v-if="variant_list">
             <a :href="item.variant_link">
                <img :src="item.file_path" alt="thumbnail" class="img-thumbnail">
             </a>
          </div>
        </div>
      </div>
      <div class="col-lg-9">
        <div class="row">
          <div class="col-md-6">
              <h3>Image info:</h3>
              <table class="table table-sm">
                <tr><th>Variant ID</th><td><span class="d-inline-block text-truncate" style="max-width: 200px;" title="{{ variant_id }}">{{ variant_id }}</span></td></tr>
                <tr><th>File path</th><td>{{ file_path }}</td></tr>
                <tr><th>File size</th><td>{{ file_size }}</td></tr>
                <tr><th>Image size</th><td>{{ image_size }}</td></tr>
              </table>
          </div>
          <div class="col-md-6">
              <h3>Date options:</h3>
              <table class="table table-sm">
                  <tr><th class="align-middle">Custom date</th><td>
                      <input type="text" value="" class="form-control form-control-sm" placeholder="YYYY-MM-DD HH:MM:SS">
                  </td></tr>
                  {% for name, date in dates.items() %}
                  <tr><th>{{ name }}</th><td>{{ date }}</td></tr>
                  {% endfor %}
              </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const { createApp, ref, onMounted } = Vue

const app = createApp({
  setup() {
      const variant_list = ref();
      const url_image = ref();
      onMounted(async () => {
      await fetch("{{ api_photo_data }}")
        .then((response) => response.json())
        .then((result) => (variant_list.value = result.variants)); 
      });
      onMounted(async () => {
      await fetch("{{ api_variant_data }}")
        .then((response) => response.json())
        .then((result) => (url_image.value = result.url_image)); 
      });
      return {
          variant_list, url_image
      }
  }
})
app.config.compilerOptions.delimiters = ['[[',']]']
app.mount('#app')
</script>
